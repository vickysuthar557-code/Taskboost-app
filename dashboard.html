<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskBoost Elite</title>
    <script src="https://www.youtube.com/iframe_api"></script> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        :root { --orange-main: #ff8c00; --bg: #f8fafc; }
        
        body { margin: 0; background-color: var(--bg); font-family: 'Plus Jakarta Sans', sans-serif; display: flex; justify-content: center; }
        .app-shell { width: 100%; max-width: 420px; min-height: 100vh; padding: 20px; box-sizing: border-box; display: flex; flex-direction: column; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .logo { font-weight: 800; font-size: 20px; color: var(--orange-main); }
        .user-info { font-size: 11px; font-weight: 700; color: #64748b; background: #fff; padding: 6px 14px; border-radius: 100px; border: 1px solid #e2e8f0; }
        
        .earning-box { background: #0f172a; border-radius: 40px; padding: 55px 20px; color: white; text-align: center; margin-bottom: 25px; position: relative; overflow: hidden; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); }
        .speedo-arc { position: absolute; bottom: -110px; left: 50%; transform: translateX(-50%) rotate(-45deg); width: 320px; height: 320px; border: 18px solid transparent; border-radius: 50%; background: conic-gradient(from 0deg at 50% 50%, #ff0000, #ff8c00, #22c55e, #ff8c00, #ff0000); -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - 18px), #fff calc(100% - 17px)); mask: radial-gradient(farthest-side, transparent calc(100% - 18px), #fff calc(100% - 17px)); opacity: 0.35; transition: transform 1.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .earn-val { font-size: 58px; font-weight: 800; margin: 5px 0; position: relative; z-index: 5; color: #ffffff; letter-spacing: -2px; }
        
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
        .stat-card { background: #fff; padding: 18px; border-radius: 20px; border: 1px solid #f1f5f9; text-align: center; }
        .stat-label { font-size: 10px; color: #94a3b8; font-weight: 700; display: block; margin-bottom: 5px; text-transform: uppercase; }
        .stat-data { font-size: 18px; font-weight: 800; color: #1e293b; }
        
        .main-watch-btn { width: 100%; padding: 22px; background: linear-gradient(90deg, #FF512F 0%, #DD2476 100%); border: none; border-radius: 25px; color: white; font-weight: 800; font-size: 18px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 25px; box-shadow: 0 15px 30px rgba(221, 36, 118, 0.3); animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.02); } }

        .upgrade-btn { background: linear-gradient(45deg, #FFD700, #FFA500); width: 100%; border: none; padding: 15px; border-radius: 18px; font-weight: 800; color: black; margin-bottom: 20px; cursor: pointer; box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4); display: none; }
        
        .plan-table { width: 100%; border-collapse: collapse; font-size: 12px; background: #fff; border-radius: 20px; margin-bottom: 20px; }
        .plan-table td { padding: 12px; border-bottom: 1px solid #f1f5f9; font-weight: 600; }
        input { width: 100%; padding: 16px; margin-bottom: 10px; border: 1px solid #e2e8f0; border-radius: 14px; box-sizing: border-box; font-family: inherit; }

        .sheet { position: fixed; bottom: -100%; left: 0; width: 100%; background: #fff; padding: 25px; border-radius: 30px 30px 0 0; transition: 0.3s; z-index: 100; box-sizing: border-box; box-shadow: 0 -10px 40px rgba(0,0,0,0.1); }
        .sheet.active { bottom: 0; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 99; }

        .upgrade-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px); z-index: 1000; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; animation: fadeIn 0.3s ease; }
        .upgrade-box { background: #1e293b; width: 100%; max-width: 400px; max-height: 90vh; overflow-y: auto; padding: 25px 20px; border-radius: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); text-align: center; border: 1px solid rgba(255, 255, 255, 0.1); box-sizing: border-box; animation: slideUp 0.3s ease-out; }
        .upgrade-header { font-size: 22px; font-weight: 800; background: linear-gradient(to right, #fbbf24, #d97706); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 5px; }
        .pkg-select { width: 100%; padding: 14px; margin: 15px 0; background: #0f172a; color: white; border: 1px solid #334155; border-radius: 12px; font-size: 14px; font-weight: 600; outline: none; }
        .payment-area { background: #ffffff; padding: 20px; border-radius: 15px; border: 1px solid #e2e8f0; margin-bottom: 20px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .qr-frame { background: #fff; padding: 5px; border: 1px solid #e2e8f0; border-radius: 10px; display: inline-block; margin-bottom: 15px; }
        .upi-row { background: #f1f5f9; border: 1px solid #cbd5e1; padding: 12px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; margin-bottom: 10px; }
        .upi-text { font-family: monospace; color: #334155; font-size: 14px; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px; }
        .pay-app-btn { width: 100%; padding: 12px; background: #22c55e; color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 14px; cursor: pointer; margin-top: 5px; }
        .utr-label { display: block; text-align: left; font-size: 12px; font-weight: bold; color: #475569; margin-top: 15px; margin-bottom: 5px; }
        .utr-input { width: 100%; padding: 12px; background: #fff; border: 1px solid #cbd5e1; border-radius: 10px; color: #0f172a; font-size: 14px; box-sizing: border-box; }
        .action-btn { width: 100%; padding: 15px; border: none; border-radius: 14px; font-weight: 800; font-size: 15px; cursor: pointer; letter-spacing: 0.5px; }
        .btn-submit { background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%); color: #0f172a; margin-bottom: 10px; }
        .btn-cancel { background: transparent; color: #94a3b8; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body onload="window.loadDashboardData()">

<div class="app-shell">
    <div class="header">
        <div class="logo">TASKBOOST</div>
        <div id="user-phone" class="user-info">ID: Loading...</div>
    </div>

    <div class="earning-box">
        <div class="speedo-arc"></div>
        <span class="stat-label" style="color:#ffffff; opacity:0.9; font-size: 20px; font-weight: 800; letter-spacing: 1px;">TOTAL EARNINGS</span>
        <div class="earn-val" id="total-earning">‚Çπ0.00</div>
        <div style="font-size:10px; background:rgba(255,255,255,0.1); display:inline-block; padding:5px 15px; border-radius:50px; font-weight:bold; position:relative; z-index:5;">
            <span id="plan-name">Loading...</span>
        </div>
    </div>

    <button id="upgrade-trigger-btn" onclick="window.openUpgradeModal()" 
    style="display:none; width:100%; padding:15px; margin:20px 0; background:linear-gradient(45deg, #FFD700, #FFA500); border:none; border-radius:12px; font-weight:bold; color:#0f172a; box-shadow:0 4px 15px rgba(255, 215, 0, 0.3);">
    üöÄ UPGRADE TO PRO
</button>

<div id="upgrade-status-msg" style="display:none; margin: 20px 0; padding: 15px; background: #fff7ed; border: 1px solid #fdba74; color: #c2410c; text-align: center; border-radius: 10px; font-weight: bold;">
    ‚è≥ Your Upgrade Request is Pending for Admin Approval.
</div>

    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-label">WITHDRAWABLE</span>
            <div class="stat-data" id="withdrawable-amount" style="color:#10b981;">‚Çπ0.00</div>
        </div>
        <div class="stat-card">
            <span class="stat-label">LIVE RATE</span>
            <div class="stat-data" id="current-rate">‚Çπ0.0000</div>
        </div>
    </div>

    <button class="main-watch-btn" onclick="document.getElementById('video-list').scrollIntoView({behavior:'smooth'})">
        <i class="fas fa-play"></i> START MISSION
    </button>

    <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:20px;">
        <button onclick="window.openWithdrawModal()" style="padding:15px; border-radius:18px; border:none; background:#0f172a; color:white; font-weight:bold;">Withdraw</button>
        <button onclick="window.loadWithdrawHistory()" style="padding:15px; border-radius:18px; border:1px solid #e2e8f0; background:white; font-weight:bold;">History</button>
    </div>

    <div id="active-video-container" style="display: none; background: #000; padding: 10px; border-radius: 10px; margin-bottom: 20px;">
        <div id="player-placeholder" style="width: 100%; border-radius: 10px;"></div>
        
        <div style="margin-top: 10px; color: white; text-align: center;">
            <h3 id="video-timer" style="color: #fbbf24; margin: 5px 0;">Watched: 0s / 600s</h3>
            <p id="video-status" style="font-size: 12px; color: #94a3b8;">Status: Stopped</p>
            <button id="claim-btn" onclick="window.claimEarnings()" disabled style="background: #334155; color: #94a3b8; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; width: 100%; margin-top: 5px;">
                WATCH FULL VIDEO TO CLAIM
            </button>
        </div>
    </div>

    <div id="video-list" style="margin-bottom:20px;"></div>

    <div style="background:white; padding:20px; border-radius:24px; margin-bottom:20px;">
        <h4 style="margin:0 0 15px 0;">Referral Rewards</h4>
        <table class="plan-table" style="width:100%;">
            <tr style="color:#94a3b8; font-size:10px;"><td>LEVEL</td><td>BONUS</td><td>RATE+</td></tr>
            <tr><td>Level 1 (Direct)</td><td style="color:#10b981;">‚Çπ100</td><td>+0.15</td></tr>
            <tr><td>Level 2</td><td style="color:#10b981;">‚Çπ50</td><td>+0.10</td></tr>
            <tr><td>Level 3-5</td><td style="color:#10b981;">‚Çπ20</td><td>+0.05</td></tr>
            <tr><td>Level 6-10</td><td style="color:#10b981;">‚Çπ10</td><td>+0.025</td></tr>
        </table>
        
        <div style="background:#f8fafc; padding:10px; border-radius:14px; border:1px solid #e2e8f0; display:flex;">
            <input type="text" id="referral-link" readonly style="border:none; background:transparent; margin:0; padding:5px; font-size:11px; flex:1;">
            <button onclick="window.copyReferralLink()" style="width:auto; padding:5px 15px; margin:0; font-size:11px; background:#ff8c00; border-radius:8px; color:white;">COPY</button>
        </div>
    </div>

    <a href="https://t.me/taskboostindia" target="_blank" style="text-align:center; display:block; padding:15px; background:#0088cc; color:white; text-decoration:none; border-radius:18px; font-weight:bold; margin-bottom:20px;">
        <i class="fab fa-telegram-plane"></i> JOIN TELEGRAM
    </a>

    <button onclick="window.logoutUser()" style="background:none; border:none; color:#cbd5e1; font-weight:bold; margin:20px 0; cursor:pointer;">LOGOUT SESSION</button>
    
    <footer style="text-align:center; font-size:10px; color:#94a3b8; padding-bottom:20px;">
        &copy; 2026 TaskBoost Elite. All Rights Reserved.<br>
        Terms & Conditions | Privacy Policy
    </footer>
</div>

<div class="overlay" id="overlay" onclick="closeSheet()"></div>
<div class="sheet" id="sheet">
    <div id="sheet-content"></div>
</div>

<div class="upgrade-overlay" id="upgrade-modal-overlay">
    <div class="upgrade-box">
        <div class="upgrade-header">UPGRADE PLAN</div>
        <p style="color: #94a3b8; font-size: 12px; margin-top: 0;">Unlock higher earnings today!</p>
        <select id="upgrade-package-select" class="pkg-select" onchange="window.fetchAdminSettings()">
            <option value="" disabled selected>Select a Package</option>
            <option value="PKG_500">‚≠ê Basic (‚Çπ500) - ‚Çπ0.50/min</option>
            <option value="PKG_1000">ü•â Bronze (‚Çπ1000) - ‚Çπ0.80/min</option>
            <option value="PKG_2000">ü•à Silver (‚Çπ2000) - ‚Çπ1.60/min</option>
            <option value="PKG_3000">ü•á Gold (‚Çπ3000) - ‚Çπ2.20/min</option>
            <option value="PKG_5000">üíé Platinum (‚Çπ5000) - ‚Çπ3.00/min</option>
            <option value="PKG_10000">üëë Diamond (‚Çπ10000) - ‚Çπ5.00/min</option>
        </select>
        <div class="payment-area">
            <h4 style="margin:0 0 15px 0; color:#0f172a;">Scan to Pay</h4>
            <div class="qr-frame">
                <img id="upgrade-qr-img" src="" style="width: 140px; height: 140px; display: block;">
            </div>
            <div class="upi-row" onclick="window.copyUPI()">
                <span id="upgrade-upi-display" class="upi-text">Loading...</span>
                <i class="fas fa-copy" style="color: #ff8c00;"></i>
            </div>
            <p style="font-size: 10px; color: #64748b; margin-top: 5px;">Tap box to Copy UPI ID</p>
            <button onclick="window.handleUpgradePay()" class="pay-app-btn">Open Payment App</button>
            <label class="utr-label">Transaction ID / UTR:</label>
            <input type="text" id="upgrade-utr" class="utr-input" placeholder="Enter 12-Digit UTR Number">
        </div>
        <button onclick="window.submitUpgradeRequest()" class="action-btn btn-submit">SUBMIT REQUEST</button>
        <button onclick="window.closeUpgradeModal()" class="action-btn btn-cancel">Close</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.43.0"></script>
<script src="app.js"></script>
<script>
    function openSheet() { document.getElementById('overlay').style.display='block'; document.getElementById('sheet').classList.add('active'); }
    function closeSheet() { document.getElementById('overlay').style.display='none'; document.getElementById('sheet').classList.remove('active'); }
    window.openUpgradeModal = function() { if(window.fetchAdminSettings) window.fetchAdminSettings(); document.getElementById('upgrade-modal-overlay').style.display = 'flex'; };
    window.closeUpgradeModal = function() { document.getElementById('upgrade-modal-overlay').style.display = 'none'; };
</script>
</body>
</html>
